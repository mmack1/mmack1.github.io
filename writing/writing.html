<!doctype html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="writing.css">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body style="font-family: 'Poppins', sans-serif; background-color: rgb(237, 250, 228);">
    <div id="typing-container"></div>

    <script src="writing.js"></script>
  </body>
  
  <!-- 
  <iframe 
  src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSYzWgXlQ8M_qa2SJ7vOD2bUZqUVi3YH0UkH1l2_fF09YHg4m7A5izVKyCtPybaQtPWMobcb8b278og/pubhtml?gid=0&single=true?widget=true&amp;headers=false"
  title="Readings I enjoy"
  width="100%" 
  height="600px" 
  style="border: none; border-radius: 10px;"">
</iframe>
 -->


<h1>Articles I enjoy</h1>
 <table id="sheet-data", class = "table", cellspacing = "0">
  <thead>
      <tr id="header-row">
          <th>Article</th>
          <th>Author</th>
          <th>Access</th>
          <th>Rating</th>
      </tr>
  </thead>
  <tbody></tbody>
</table>


<script>
fetch("https://script.google.com/macros/s/AKfycbwvxFd7w_Mg6sH88jtrS4jSCtnNqkk_qNhP16kQ6fuB4KO5ZXHkn5beUeApmwSgqPmE/exec", {
      redirect: "follow",
      method: "GET",
      headers: {
        "Content-Type": "text/plain", // Set correct content-type for JSON
      }, })
  .then(response => response.json())  // Parse response to JSON
  .then(data => {
      let tableHead = document.getElementById("header-row");
      console.log(data); // Check the structure of the data
      
      let tbody = document.querySelector("#sheet-data tbody");

      // ✅ Clear previous content (avoids duplication)
      tableHead.innerHTML = "";
      tbody.innerHTML = "";

      // ✅ Add header row
      data[0].forEach(header => {
          let th = document.createElement("th");
          th.textContent = header;
          tableHead.appendChild(th);
      });

      // ✅ Add table rows
      data.slice(1).forEach(row => {
          let tr = document.createElement("tr");
          row.forEach(cell => {
              let td = document.createElement("td");
              td.textContent = cell;
              tr.appendChild(td);
          });
          tbody.appendChild(tr);
      });
  })
  .catch(error => console.error("Error fetching Google Sheets data:", error));
</script>

<!-- <style>
table {
  width: 100%;
  border-collapse: collapse;
  font-family: Arial, sans-serif;
}
th, td {
  border: 5px solid black;
  padding: 8px;
}
th {
  background-color: blue;
  color: white;
}
</style> -->


</html>
